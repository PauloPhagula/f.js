/*!
 * F - a JavaScript framework for modular and scalable SPAs
 */
var F=function(t,r,o){"use strict";var e={},n=e;return e.VERSION="0.1.0",e.DEBUG=!1,e.noConflict=function(){return e=n,this},e.compose=r.extend,e.extend=function(t,o){var e,n=this;return e=t&&r.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},r.extend(e,n,o),e.prototype=r.create(n.prototype,t),e.prototype.constructor=e,e.__super__=n.prototype,e},e}(jQuery,_);
F.Core=function(r,e,t){"use strict";function n(){}var o={},s={},i={};return F.compose(n.prototype,{dispatcher:e,registerExtension:function(r,e,t,n){if(o.hasOwnProperty(r))throw new Error("An extension with the given name has already been registered. Ext name: "+r);e=e||[],n=n||{};var s=e;s.push(t);var i=F.injector.resolve(s);i.init(n),o[r]=i,F.injector.register(r,i)},registerStore:function(r,e){i[r]=e},registerModule:function(r,e,t,n,i){if(o.hasOwnProperty(r))throw new Error("Module with given name has already been registered. Mod name: "+r);s[r]={factory:n,extensions:e,stores:t,options:i,instance:null}},start:function(r,e){if(!s.hasOwnProperty(r))throw new Error("Trying to start non-registered module: "+r);var t=s[r],n=new F.Sandbox(this,r,e);t.instance=new t.factory(n,r,t.options);for(var a={},h={},c=0;c<t.extensions.length;c++){var u=t.extensions[c];if(!o.hasOwnProperty(u))throw new Error("Module requires an unregistered extensions: "+u);a[u]=o[u]}for(var c=0;c<t.stores.length;c++){var f=t.stores[c];if(!i.hasOwnProperty(f))throw new Error("Module requires an unregistered store: "+f);h[f]=i[f]}t.instance.start(e,a,h)},stop:function(r){var e=s[r];e.instance&&(e.instance.stop(),e.instance=null)},restart:function(r){this.stop(r),this.start(r)},startAll:function(){for(var r in s)s.hasOwnProperty(r)&&this.start(r)},stopAll:function(){for(var r in s)s.hasOwnProperty(r)&&this.stop(r)},reportError:function(r,e,t){this.log(r,e,t)},init:function(){}}),n.extend=F.extend,n}(F.injector,F.dispatcher);
F.Sandbox=function(t){"use strict";function e(t,e,i){this.core=t,this.moduleName=e,this.element=i}return F.compose(e.prototype,{moduleCanPublish:function(t,e){return!0},publish:function(t,e,i,o){this.moduleCanPublish(this.moduleName,t)&&this.core.dispatcher.publish.call(t,e)},moduleCanDispatchAction:function(t,e){return!0},dispatch:function(t,e){if(!this.moduleCanDispatchAction(this.moduleName,t))throw new Error("module "+this.moduleName+" is not authorized to create action: "+action);this.core.dispatcher.dispatch({type:t,data:e})},subscribe:function(t,e,i){this.core.dispatcher.subscribe(t,e,i)},unsubscribe:function(t,e){this.core.dispatcher.unsubscribe(t,e)},request:function(t,e){return this.core.http.request(t,e)},getConfig:function(t){return this.core.getModuleConfig(this.element,t)},reportError:function(t,e,i){return this.core.reportError(t,e,i)}}),e.extend=F.extend,e}();
F.Store=function(t){"use strict";function i(t,i){this._dispatcher=t,this._name=i,this._isUpdating=!1,this._data=[],this.actions={},this.init.apply(this,arguments)}var a="CHANGE";return F.compose(i.prototype,{init:function(){throw new Error("Store initialization not done. Override this function")},addChangeListener:function(t){this._callbacks||(this._callbacks={});(this._callbacks[a]||(this._callbacks[a]=[])).push({callback:t})},removeChangeListener:function(t){var i,n,s,e;if(!(n=this._callbacks))return this;if(!(i=this._callbacks[a]))return this;for(s=0,e=i.length;e>s;s++){var c=i[s];c===t&&i.splice(s)}},emitChange:function(){var t,i,n,s;if(!(i=this._callbacks))return this;if(!(t=this._callbacks[a]))return this;for(n=0,s=t.length;s>n;n++){var e=t[n];e.callback.apply()}}}),i.extend=F.extend,i}();
F.Extension=function(t){"use strict";function n(){}return F.compose(n.prototype,{init:function(t){this._defaults={},this._options=$.extend({},this._defaults,t)}}),n.extend=F.extend,n}();
F.Module=function(t){"use strict";function n(t,n,o){this._sandbox=t,this._name=n,this._defaults={},this._options={},this._extensions={},this._stores={},this._options=$.extend({},this._defaults,o),this.$el=null,this.el=null}return F.compose(n.prototype,{start:function(t,n,o){throw new Error("Module initialization not done. Override this function")},stop:function(){throw new Error("Module stopping not done. Override this function")}}),n.extend=F.extend,n}();
F.router=function(n,r,t){"use strict";var o={$container:null,anchorMap:{page:"home",title:"Home"}},e=r.create();e.normalizeFn=r.NORM_AS_OBJECT;var a=function(){return n.extend(!0,{},o.anchorMap)},c=function(r){var t,c=a();try{t=n.uriAnchor.makeAnchorMap()}catch(i){return n.uriAnchor.setAnchor(c,null,!0),!1}o.anchorMap=t,document.title=t.title||"";var h="/",u=window.location.hash;return u.length>0&&(h=u.split("#").pop()),e.parse(h),!1},i=function(r){var t={prop:n(this).prop("href"),attr:n(this).attr("href")};t.attr.indexOf("javascript:void(0)")>-1||(r.preventDefault(),window.location.hash=t.attr)},h=function(n,r){e.addRoute(n,r)},u=function(){n.uriAnchor.configModule({schema_map:o.anchorMap}),n(window).on("hashchange",c).trigger("hashchange"),n(document).on("click","a[href]:not([data-external])",i)},s=function(){n(window).off("hashchange",c),n(document).off("click",i)},f=function(r){var t,e,c=a(),i=!0;n:for(t in r)if(r.hasOwnProperty(t)){if(0===t.indexOf("_"))continue n;c[t]=r[t],e="_"+t,r[e]?c[e]=r[e]:(delete c[e],delete c["_s"+e])}try{n.uriAnchor.setAnchor(c)}catch(h){n.uriAnchor.setAnchor(o.anchorMap,null,!0),i=!1}return i};return{add:h,go:f,start:u,stop:s}}(jQuery,crossroads);