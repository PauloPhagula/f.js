/*!
 * f, v0.1.4 (2016/07/10 11:32)
 * A JavaScript framework for modular and scalable SPAs.
 * <https://github.com/dareenzo/f-es>
 *
 * Author: Paulo Phagula <https://dareenzo.github.io/>
 * License: MIT
 * 
 */
!function(){var t=function(t){"use strict";var n={},e=n;return n.VERSION="0.1.4",n.DEBUG=!1,n.noConflict=function(){return n=e,this},Object.getOwnPropertyDescriptors=function(t){var n={};for(var e in t)t.hasOwnProperty(e)&&(n[e]=Object.getOwnPropertyDescriptor(t,e));return n},n.compose=Object.assign,n.extend=function(t,n){var e,r=this;return t.hasOwnProperty("constructor")||Object.defineProperty(t,"constructor",{value:function(){r.apply(this,arguments)},writable:!0,configurable:!0,enumerable:!1}),e=t.constructor,Object.assign(e,r,n),e.prototype=Object.create(r.prototype,Object.getOwnPropertyDescriptors(t)),e.prototype.constructor=e,e.__super__=r.prototype,e},n.dispatcher=function(t){var n="ID_",e="ACTION",r=!1,i={},o={},s=1,a=null,c=function(t){if(r)throw new Error("Cannot run "+t+"in the middle of a dispatch.")};return{subscribe:function(t,e,r){c("Dispatcher.subscribe(...)");var i=(this._callbacks||(this._callbacks={}),n+s++);return(this._callbacks[t]||(this._callbacks[t]=[])).push({callback:e,context:r,id:i}),i},unsubscribe:function(t,n){c("Dispatcher.subscribe(...)");var e,r,i,o;if(!(r=this._callbacks[t]))return this;if(!(e=this._callbacks[t]))return this;for(i=0,o=e.length;o>i;i++){var s=e[i];s===n&&e.splice(i)}},publish:function(){var t=Array.prototype.slice.call(arguments,0),n=t.shift();if(n!==e){var r,i,s,a;if((i=this._callbacks)&&(r=this._callbacks[n]))for(s=0,a=r.length;a>s;s++){var c=r[s];c.callback.apply(c.context||null,t)}}else{this._startDispatching(t);try{var u,l,h,f;if(!(l=this._callbacks))return;if(!(u=this._callbacks[e]))return;for(h=0,f=u.length;f>h;h++){var p=u[h];o[p.id]||p.callback.apply(p.context||null,t)}}finally{this._stopDispatching()}}},dispatch:function(t){c("Dispatcher.dispatch(...)"),this.publish(e,t)},waitFor:function(t){c("Dispatcher.waitFor(...)");for(var n=function(t){t.id===s&&(a=t)},r=0;r<t.length;r++){var s=t[r];if(o[s]){if(!i[s])throw new Error("dispatcher.waitFor(...): Circular dependency detected while waiting for "+s)}else{var a=null;if(this._callbacks[e].forEach(n(handler)),!a)throw new Error("dispatcher.waitFor(...):"+s+" does not map to a registered callback.");o[s]=!0,a.callback.apply(a.context||null),i[s]=!0}}},_startDispatching:function(t){var n,s,c,u;if((s=this._callbacks)&&(n=this._callbacks[e])){for(c=0,u=n.length;u>c;c++){var l=n[c];o[l.id]=!1,i[l.id]=!1}a=t,r=!0}},_stopDispatching:function(){a=null,r=!1}}}(),n.injector=function(t){function n(t){var n,e,r,o;return"function"==typeof t?(n=t.$inject)||(n=[],t.length&&(e=t.toString().replace(p,""),r=e.match(l),r[1].split(h).forEach(function(t){t.replace(f,function(t,e,r){n.push(r)})})),t.$inject=n):i(t)?(o=t.length-1,c(t[o],"fn"),n=t.slice(0,o)):c(t,"fn",!0),n}function e(t,n){u[t]=n}function r(t,e,r){var o,s,a,c=[],l=n(t);for(s=0,o=l.length;o>s;s++){if(a=l[s],"string"!=typeof a)throw new Error("Incorrect injection token! Expected service name as string, got: "+a);c.push(r&&r.hasOwnProperty(a)?r[a]:u[a])}return i(t)&&(t=t[o]),t.apply(e||{},c)}function i(t){return"[object Array]"===Object.prototype.toString.call(t)}function o(t){return"function"==typeof t}function s(t){return function(){var n,e,r=arguments[0],i="["+(t?t+":":"")+r+"] ",o=arguments[1],s=arguments,a=function(t){return"function"==typeof t?t.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof t?"undefined":"string"!=typeof t?JSON.stringify(t):t};for(n=i+o.replace(/\{\d+\}/g,function(t){var n,e=+t.slice(1,-1);return e+2<s.length?(n=s[e+2],"function"==typeof n?n.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof n?"undefined":"string"!=typeof n?toJson(n):n):t}),n=n+"\nhttp://errors.angularjs.org/1.2.27/"+(t?t+"/":"")+r,e=2;e<arguments.length;e++)n=n+(2==e?"?":"&")+"p"+(e-2)+"="+encodeURIComponent(a(arguments[e]));return new Error(n)}}function a(t,n,e){if(!t)throw d("areq","Argument '{0}' is {1}",n||"?",e||"required");return t}function c(t,n,e){return e&&i(t)&&(t=t[t.length-1]),a(o(t),n,"not a function, got "+(t&&"object"==typeof t?t.constructor.name||"Object":typeof t)),t}var u={},l=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,h=/,/,f=/^\s*(_?)(\S+?)\1\s*$/,p=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,d=s("ng");return{register:e,resolve:r}}(),n.router=function(t,n){var e=new t,r=function(t){var n=t.target;if("A"===n.tagName&&!n.hasAttribute("data-external")){var r=n.href;if(r.indexOf("javascript:void(0)")>-1)return;if(-1===r.indexOf("#/"))return;t.preventDefault(),r="/"+r.split("#/")[1],e.navigate(r)}},i=function(t,n){e.on(t,n)},o=function(){document.addEventListener("click",r)},s=function(){document.removeEventListener("click",r)},a=function(t){e.navigate(t)};return{add:i,navigate:a,start:o,stop:s}}(t),n.Core=function(t,e,r,i){function o(){u={},l={},h={},f={},p=!1}function s(t){if(u.debug)throw t;e.publish("error",{exception:t})}function a(t,n){var e,r,i=function(t,e){return function(){var r=n+"."+t+"() - ";try{return e.apply(this,arguments)}catch(i){i.methodName=t,i.objectName=n,i.name=r+i.name,i.message=r+i.message,s(i)}}};for(e in t)r=t[e],"function"==typeof r&&(t[e]=i(e,r))}function c(){}var u={debug:!1},l={},h={},f={},p=!1;return n.compose(c.prototype,{init:function(t){u=n.compose({},u,t),this.startAll(document.documentElement),r.start(),e.publish("app init"),p=!0},destroy:function(){this.stopAll(document.documentElement),o(),r.stop()},registerExtension:function(t,e,r,i){if(l.hasOwnProperty(t))return s(new Error("An extension with the given name has already been registered. Ext name: "+t));e=e||[],i=i||{};var o=e;o.push(r);var a=n.injector.resolve(o);a.init(i),l[t]=a,n.injector.register(t,a)},registerStore:function(t,n){f[t]=n},registerModule:function(t,n,e,r,i){return h.hasOwnProperty(t)?s(new Error("Module with given name has already been registered. Mod name: "+t)):void(h[t]={factory:r,extensions:n,stores:e,options:i,instance:null})},start:function(t,e){if(!h.hasOwnProperty(t))return s(new Error("Trying to start non-registered module: "+t));var r=h[t],i=new n.Sandbox(this,t,e);r.instance=new r.factory(i,t,r.options);var o,c={},p={};for(o=0;o<r.extensions.length;o++){var d=r.extensions[o];if(!l.hasOwnProperty(d))return s(new Error("Module requires an unregistered extensions: "+d));c[d]=l[d]}for(o=0;o<r.stores.length;o++){var g=r.stores[o];if(!f.hasOwnProperty(g))return s(new Error("Module requires an unregistered store: "+g));p[g]=f[g]}u.debug||a(r.instance,t),r.instance.start(e,c,p)},stop:function(t){var n=h[t];return n&&n.instance?(n.instance.stop(),void(n.instance=null)):s(new Error("Unable to stop module: "+t))},restart:function(t){this.stop(t),this.start(t)},startAll:function(t){for(var n in h)h.hasOwnProperty(n)&&this.start(n);return this},stopAll:function(t){for(var n in h)h.hasOwnProperty(n)&&this.stop(n);return this},dispatcher:e,router:r,getConfig:function(t){return"undefined"==typeof t?u:t in u?u[t]:null},setConfig:function(t){return p?s(new Error("Cannot set configuration after application is initialized")):void(u=n.compose({},u,t))},reportError:s}),c.extend=n.extend,c}(n.injector,n.dispatcher,n.router),n.Sandbox=function(t){function e(t,n,e){this.core=t,this.moduleName=n,this.element=e}return n.compose(e.prototype,{moduleCanPublish:function(t,n){return!0},publish:function(t,n,e,r){this.moduleCanPublish(this.moduleName,t)&&this.core.dispatcher.publish.call(t,n)},moduleCanDispatchAction:function(t,n){return!0},dispatch:function(t,n){if(!this.moduleCanDispatchAction(this.moduleName,t))throw new Error("module "+this.moduleName+" is not authorized to create action: "+action);this.core.dispatcher.dispatch({type:t,data:n})},subscribe:function(t,n,e){this.core.dispatcher.subscribe(t,n,e)},unsubscribe:function(t,n){this.core.dispatcher.unsubscribe(t,n)},getConfig:function(t){return this.core.getConfig(this.element,t)},reportError:function(t){return this.core.reportError(t)}}),e.extend=n.extend,e}(),n.Store=function(t){function e(t,n){var e=this;this._dispatcher=t,this._name=n,this._changed=!1,this._data=[],this._dispatchFlow=function(t){e._changed=!1,e._handleDispatch(t),e._changed&&e.emitChange()},e._dispatchToken=t.subscribe(i,this._dispatchFlow),this.actions={},this.init.apply(this,arguments)}var r="CHANGE",i="ACTION";return n.compose(e.prototype,{init:function(){throw new Error("Store initialization not done. Override this function")},_handleDispatch:function(t){throw new Error("Store payload handling not done. Override this function")},getDispatchToken:function(){return this._dispatchToken},addChangeListener:function(t){this._callbacks||(this._callbacks={});(this._callbacks[r]||(this._callbacks[r]=[])).push({callback:t})},removeChangeListener:function(t){var n,e,i,o;if(!(e=this._callbacks))return this;if(!(n=this._callbacks[r]))return this;for(i=0,o=n.length;o>i;i++){var s=n[i];s===t&&n.splice(i)}},emitChange:function(){var t,n,e,i;if(!(n=this._callbacks))return this;if(!(t=this._callbacks[r]))return this;for(e=0,i=t.length;i>e;e++){var o=t[e];o.callback.apply()}}}),e.extend=n.extend,e}(),n.Extension=function(t){function e(){}return n.compose(e.prototype,{init:function(t){this._defaults={},this._options=n.compose({},this._defaults,t)}}),e.extend=n.extend,e}(),n.Module=function(t){function e(t,e,r){this._sandbox=t,this._name=e,this._defaults={},this._options={},this._extensions={},this._stores={},this._options=n.compose({},this._defaults,r),this.$el=null,this.el=null}return n.compose(e.prototype,{start:function(t,n,e){throw new Error("Module initialization not done. Override this function")},stop:function(){throw new Error("Module stopping not done. Override this function")}}),e.extend=n.extend,e}(),n};"function"==typeof define&&define.amd?define(["navigo"],t):"undefined"!=typeof module&&module.exports?module.exports=t(require("navigo")):window.F=t(window.Navigo)}();