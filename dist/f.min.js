/*!
 * F - a JavaScript framework for modular and scalable SPAs
 */
var F=function(t){"use strict";var r={},e=r;return r.VERSION="0.1.3",r.DEBUG=!1,r.noConflict=function(){return r=e,this},Object.getOwnPropertyDescriptors=function(t){var r={};for(var e in t)t.hasOwnProperty(e)&&(r[e]=Object.getOwnPropertyDescriptor(t,e));return r},r.compose=Object.assign,r.extend=function(t,r){var e,o=this;return t.hasOwnProperty("constructor")||Object.defineProperty(t,"constructor",{value:function(){o.apply(this,arguments)},writable:!0,configurable:!0,enumerable:!1}),e=t.constructor,Object.assign(e,o,r),e.prototype=Object.create(o.prototype,Object.getOwnPropertyDescriptors(t)),e.prototype.constructor=e,e.__super__=o.prototype,e},r}();
F.dispatcher=function(t){"use strict";var a="ID_",l="ACTION",c=!1,i={},r={},s=1,n=null;return{subscribe:function(t,l,c){var i=(this._callbacks||(this._callbacks={}),a+s++);return(this._callbacks[t]||(this._callbacks[t]=[])).push({callback:l,context:c,id:i}),i},unsubscribe:function(t,a){var l,c,i,r;if(!(c=this._callbacks[t]))return this;if(!(l=this._callbacks[t]))return this;for(i=0,r=l.length;r>i;i++){var s=l[i];s===a&&l.splice(i)}},publish:function(){var t=Array.prototype.slice.call(arguments,0),a=t.shift();if(a!==l){var c,i,s,n;if((i=this._callbacks)&&(c=this._callbacks[a]))for(s=0,n=c.length;n>s;s++){var e=c[s];e.callback.apply(e.context||null,t)}}else{this._start(t);try{var h,o,u,f;if(!(o=this._callbacks))return;if(!(h=this._callbacks[l]))return;for(u=0,f=h.length;f>u;u++){var b=h[u];r[b.id]||b.callback.apply(b.context||null,t)}}finally{this._stop()}}},dispatch:function(t){this.publish(l,t)},waitFor:function(t){for(var a=function(t){t.id===s&&(n=t)},c=0;c<t.length;c++){var s=t[c];if(r[s]){if(!i[s])throw new Error("dispatcher.waitFor(...): Circular dependency detected while waiting for "+s)}else{var n=null;if(this._callbacks[l].forEach(a(handler)),!n)throw new Error("dispatcher.waitFor(...):"+s+" does not map to a registered callback.");r[s]=!0,n.callback.apply(n.context||null),i[s]=!0}}},_start:function(t){var a,s,e,h;if((s=this._callbacks)&&(a=this._callbacks[l])){for(e=0,h=a.length;h>e;e++){var o=a[e];r[o.id]=!1,i[o.id]=!1}n=t,c=!0}},_stop:function(){n=null,c=!1}}}();
F.injector=function(n){"use strict";function t(n){var t,e,r,i;return"function"==typeof n?(t=n.$inject)||(t=[],n.length&&(e=n.toString().replace(l,""),r=e.match(g),r[1].split(a).forEach(function(n){n.replace(p,function(n,e,r){t.push(r)})})),n.$inject=t):o(n)?(i=n.length-1,f(n[i],"fn"),t=n.slice(0,i)):f(n,"fn",!0),t}function e(n,t){s[n]=t}function r(n,e,r){var i,u,c,f=[],g=t(n);for(u=0,i=g.length;i>u;u++){if(c=g[u],"string"!=typeof c)throw new Error("Incorrect injection token! Expected service name as string, got: "+c);f.push(r&&r.hasOwnProperty(c)?r[c]:s[c])}return o(n)&&(n=n[i]),n.apply(e||{},f)}function o(n){return"[object Array]"===Object.prototype.toString.call(n)}function i(n){return"function"==typeof n}function u(n){return function(){var t,e,r=arguments[0],o="["+(n?n+":":"")+r+"] ",i=arguments[1],u=arguments,c=function(n){return"function"==typeof n?n.toString().replace(/ \{[\s\S]*$/,""):"undefined"==typeof n?"undefined":"string"!=typeof n?JSON.stringify(n):n};for(t=o+i.replace(/\{\d+\}/g,function(n){var t,e=+n.slice(1,-1);return e+2<u.length?(t=u[e+2],"function"==typeof t?t.toString().replace(/ ?\{[\s\S]*$/,""):"undefined"==typeof t?"undefined":"string"!=typeof t?toJson(t):t):n}),t=t+"\nhttp://errors.angularjs.org/1.2.27/"+(n?n+"/":"")+r,e=2;e<arguments.length;e++)t=t+(2==e?"?":"&")+"p"+(e-2)+"="+encodeURIComponent(c(arguments[e]));return new Error(t)}}function c(n,t,e){if(!n)throw y("areq","Argument '{0}' is {1}",t||"?",e||"required");return n}function f(n,t,e){return e&&o(n)&&(n=n[n.length-1]),c(i(n),t,"not a function, got "+(n&&"object"==typeof n?n.constructor.name||"Object":typeof n)),n}var s={},g=/^function\s*[^\(]*\(\s*([^\)]*)\)/m,a=/,/,p=/^\s*(_?)(\S+?)\1\s*$/,l=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,y=u("ng");return{register:e,resolve:r}}();
F.router=function(t,e){"use strict";var n=new t,i=function(t){var e=t.target;if("A"===e.tagName&&!e.hasAttribute("data-external")){var i=e.href;if(i.indexOf("javascript:void(0)")>-1)return;if(-1===i.indexOf("#/"))return;t.preventDefault(),i="/"+i.split("#/")[1],n.navigate(i)}},a=function(t,e){n.on(t,e)},r=function(){document.addEventListener("click",i)},u=function(){document.removeEventListener("click",i)},c=function(t){n.navigate(t)};return{add:a,navigate:c,start:r,stop:u}}(Navigo);
F.Core=function(e,t,n,r){"use strict";function o(){u={},c={},f={},p={},d=!1}function i(e){if(u.debug)throw e;t.publish("error",{exception:e})}function s(e,t){var n,r,o=function(e,n){return function(){var r=t+"."+e+"() - ";try{return n.apply(this,arguments)}catch(o){o.methodName=methodName,o.objectName=t,o.name=r+o.name,o.message=r+o.message,i(o)}}};for(n in e)r=e[n],"function"==typeof r&&(e[n]=o(n,r))}function a(){}var u={debug:!1},c={},f={},p={},d=!1;return F.compose(a.prototype,{init:function(e){u=F.compose({},u,e),this.startAll(document.documentElement),n.start(),t.publish("app init"),d=!0},destroy:function(){this.stopAll(document.documentElement),o(),n.stop()},registerExtension:function(e,t,n,r){if(c.hasOwnProperty(e))return i(new Error("An extension with the given name has already been registered. Ext name: "+e));t=t||[],r=r||{};var o=t;o.push(n);var s=F.injector.resolve(o);s.init(r),c[e]=s,F.injector.register(e,s)},registerStore:function(e,t){p[e]=t},registerModule:function(e,t,n,r,o){return f.hasOwnProperty(e)?i(new Error("Module with given name has already been registered. Mod name: "+e)):void(f[e]={factory:r,extensions:t,stores:n,options:o,instance:null})},start:function(e,t){if(!f.hasOwnProperty(e))return i(new Error("Trying to start non-registered module: "+e));var n=f[e],r=new F.Sandbox(this,e,t);n.instance=new n.factory(r,e,n.options);var o,a={},d={};for(o=0;o<n.extensions.length;o++){var h=n.extensions[o];if(!c.hasOwnProperty(h))return i(new Error("Module requires an unregistered extensions: "+h));a[h]=c[h]}for(o=0;o<n.stores.length;o++){var l=n.stores[o];if(!p.hasOwnProperty(l))return i(new Error("Module requires an unregistered store: "+l));d[l]=p[l]}u.debug||s(n.instance,e),n.instance.start(t,a,d)},stop:function(e){var t=f[e];return t&&t.instance?(t.instance.stop(),void(t.instance=null)):i(new Error("Unable to stop module: "+e))},restart:function(e){this.stop(e),this.start(e)},startAll:function(e){for(var t in f)f.hasOwnProperty(t)&&this.start(t);return this},stopAll:function(e){for(var t in f)f.hasOwnProperty(t)&&this.stop(t);return this},dispatcher:t,router:n,getConfig:function(e){return"undefined"==typeof e?u:e in u?u[e]:null},setConfig:function(e){return d?i(new Error("Cannot set configuration after application is initialized")):void(u=F.compose({},u,e))},reportError:i}),a.extend=F.extend,a}(F.injector,F.dispatcher,F.router);
F.Sandbox=function(t){"use strict";function e(t,e,i){this.core=t,this.moduleName=e,this.element=i}return F.compose(e.prototype,{moduleCanPublish:function(t,e){return!0},publish:function(t,e,i,o){this.moduleCanPublish(this.moduleName,t)&&this.core.dispatcher.publish.call(t,e)},moduleCanDispatchAction:function(t,e){return!0},dispatch:function(t,e){if(!this.moduleCanDispatchAction(this.moduleName,t))throw new Error("module "+this.moduleName+" is not authorized to create action: "+action);this.core.dispatcher.dispatch({type:t,data:e})},subscribe:function(t,e,i){this.core.dispatcher.subscribe(t,e,i)},unsubscribe:function(t,e){this.core.dispatcher.unsubscribe(t,e)},getConfig:function(t){return this.core.getConfig(this.element,t)},reportError:function(t){return this.core.reportError(t)}}),e.extend=F.extend,e}();
F.Store=function(t){"use strict";function i(t,i){this._dispatcher=t,this._name=i,this._isUpdating=!1,this._data=[],this.actions={},this.init.apply(this,arguments)}var a="CHANGE";return F.compose(i.prototype,{init:function(){throw new Error("Store initialization not done. Override this function")},addChangeListener:function(t){this._callbacks||(this._callbacks={});(this._callbacks[a]||(this._callbacks[a]=[])).push({callback:t})},removeChangeListener:function(t){var i,n,s,e;if(!(n=this._callbacks))return this;if(!(i=this._callbacks[a]))return this;for(s=0,e=i.length;e>s;s++){var c=i[s];c===t&&i.splice(s)}},emitChange:function(){var t,i,n,s;if(!(i=this._callbacks))return this;if(!(t=this._callbacks[a]))return this;for(n=0,s=t.length;s>n;n++){var e=t[n];e.callback.apply()}}}),i.extend=F.extend,i}();
F.Extension=function(t){"use strict";function n(){}return F.compose(n.prototype,{init:function(t){this._defaults={},this._options=F.compose({},this._defaults,t)}}),n.extend=F.extend,n}();
F.Module=function(t){"use strict";function o(t,o,n){this._sandbox=t,this._name=o,this._defaults={},this._options={},this._extensions={},this._stores={},this._options=F.compose({},this._defaults,n),this.$el=null,this.el=null}return F.compose(o.prototype,{start:function(t,o,n){throw new Error("Module initialization not done. Override this function")},stop:function(){throw new Error("Module stopping not done. Override this function")}}),o.extend=F.extend,o}();